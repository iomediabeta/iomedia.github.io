<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Github Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="assets/lib/perfect-scrollbar/css/perfect-scrollbar.min.css" />
  <link rel="stylesheet" type="text/css" href="assets/lib/material-design-icons/css/material-design-iconic-font.min.css" />
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <link rel="stylesheet" type="text/css" href="assets/lib/datatables/css/dataTables.bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/style.css" type="text/css" />
</head>

<body>
  <div class="be-wrapper be-nosidebar-left">
    <nav class="navbar navbar-default navbar-fixed-top be-top-header">
      <div class="container-fluid">
        <div id="be-navbar-collapse" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="#">Home</a></li>
            <li><a href="#">Page 1</a></li>
            <li><a href="#">Page 2</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="be-content">
      <div class="main-content container-fluid">
        <div class="row">
          <div class="col-sm-12">
            <div class="panel panel-default panel-table">
              <div class="panel-heading">Báo cáo
                <div class="tools"><span class="icon mdi mdi-download"></span><span class="icon mdi mdi-more-vert"></span></div>
              </div>
              <div class="panel-body">
                <table id="table-mlab" class="table table-striped table-hover table-fw-widget">
                  <thead>
                    <tr>
                      <th>Bộ IO</th>
                      <th>Thời gian</th>
                      <th>Cột 1</th>
                      <th>Cột 2</th>
                      <th>Cột 3</th>
                      <th>Cột 4</th>
                      <th>Cột 5</th>
                    </tr>
                  </thead>
                  <tbody id="mlab-row">

                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
  <script src="assets/lib/jquery/jquery.min.js" type="text/javascript"></script>
  <script src="assets/lib/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="assets/js/main.min.js"></script>
  <script src="assets/lib/datatables/js/jquery.dataTables.min.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/js/dataTables.bootstrap.min.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/dataTables.buttons.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.html5.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.flash.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.print.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.colVis.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.bootstrap.js" type="text/javascript"></script>
  <script src="assets/js/app-tables-datatables.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      // Kết nối dữ liệu mlab
      let api = "rT_GFFPSlEq7vFifcx-4KOJvOuH2W_nO";
      let database = "vsyscali1";
      let collection = "trash";
      let limit = "1000";

      let mlab = `https://api.mlab.com/api/1/databases/${database}/collections/${collection}?apiKey=${api}&l=${limit}`;

      function convertDate(datetime) {
        const regex = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}).(\d{3})Z$/;
        const subst = `$3/$2/$1 $4:$5:$6`;
        return datetime != "" ? datetime.replace(regex, subst) : datetime;
      }

      $.get(mlab + "&l=1000", (data) => {
        let row = "";

        data.forEach(d => {
          row += `<tr class="gradeA"><td>${d.id}</td><td>${convertDate(d.t.$date)}</td><td>${d.c1}</td><td class="center">${d.c2}</td><td class="center">${d.c3}</td><td class="center">${d.c4}</td><td class="center">${d.c5}</td></tr>`;
        });
        $("#mlab-row").html(row);

        App.dataTables();
      });
    });
  </script>
</body>

</html>